
function setCheckedStart(value) {
    var stars = document.getElementsByClassName('block-rating-star');
    for(var i = 0; i < 5; i++) {
        stars[i].children [0].className = 'star-img'
        stars[i].children [1].className = 'star-img d-none'
    }

    for(var i = 0; i < value; i++) {
        stars[i].children [0].className = 'star-img d-none'
        stars[i].children [1].className = 'star-img'
    }
}

function setUnCheckedStart(value) {
    var stars = document.getElementsByClassName('block-rating-star');
    var rating_value = document.getElementById('rating').value
    for(var i = rating_value; i < value; i++) {
        stars[i].children [0].className = 'star-img'
        stars[i].children [1].className = 'star-img d-none'
    }
}

function starOn(value) {
    var stars = document.getElementsByClassName('block-rating-star');
    for(var i = 0; i < value; i++) {
        stars[i].children [0].className = 'star-img d-none'
        stars[i].children [1].className = 'star-img'
    }
}

function setRating(value) {
    document.getElementById('rating').value = value
    setCheckedStart(value)
}

var stars = document.getElementsByClassName('block-rating-star');
stars.forEach(element => {
    element.addEventListener('mouseover', (event) =>{
        starOn(element.dataset.block_rating)
    })
    element.addEventListener('mouseout', (event) =>{
        setUnCheckedStart(element.dataset.block_rating)
    })
    element.addEventListener('click', (event)=> {
        setRating(element.dataset.block_rating);
    })
});
/*
function fadeOutEffect() {
    var fadeEffect = setInterval(function (){
        var rating_form = document.getElementById('rating_form')
        var rating_message = document.getElementById('rating_message')
        if(rating_form && rating_message) {
            if(!rating_message.style.opacity){
                rating_message.style.opacity = 1
                rating_form.style.opacity = 0
            } 
            if (rating_message.style.opacity > 0) {
                rating_message.style.opacity -= 0.1;
                rating_form.style.opacity += 1;
            } else {
                clearInterval(fadeEffect);
            }
        }
    }, 200)
}*/


if(document.getElementById("edit_rating_button")) {
    document.getElementById("edit_rating_button").addEventListener('click', (event) => {
        document.getElementById('rating_message').style.display = 'none';
        document.getElementById('rating_form').style.display = 'block';
    });
    document.getElementById("cancel_rating_button").addEventListener('click', (event) => {
        document.getElementById('rating_message').style.display = 'flex';
        document.getElementById('rating_form').style.display = 'none';
    });
} 

(function() {
   // your page initialization code here
   // the DOM will be available here
    if(document.getElementById('rating'))
      setCheckedStart(document.getElementById('rating').value) 
})();